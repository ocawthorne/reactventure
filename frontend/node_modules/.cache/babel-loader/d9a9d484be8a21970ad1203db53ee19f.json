{"ast":null,"code":"export const signup = userData => {\n  return dispatch => {\n    fetch(`http://localhost:3000/api/v1/users`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      credentials: \"include\",\n      body: JSON.stringify({\n        user: userData\n      })\n    }).then(res => res.json()).then(data => {\n      dispatch({\n        type: \"AUTH_SUCCESS\",\n        payload: {\n          loggedIn: true,\n          currentUser: data.user\n        }\n      });\n      dispatch(save(data.user, [], // History\n      [], // Inventory\n      ['crowbar', 'door', 'desk', 'drawer', 'paper', 'candle', 'chest'], // knownObjects\n      [], // brokenObjects\n      {\n        openedChest: false,\n        meltedIce: false,\n        completedGame: false\n      } // uniqueEvents\n      )); // Default values at beginning of game\n    });\n  };\n};\nexport const login = (userData, history) => {\n  return dispatch => {\n    fetch(\"http://localhost:3000/api/v1/sessions\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      credentials: 'include',\n      body: JSON.stringify(userData)\n    }).then(resp => resp.json()).then(data => {\n      if (data.error) {\n        alert(data.error);\n      } else {\n        dispatch({\n          type: \"AUTH_SUCCESS\",\n          payload: {\n            loggedIn: true,\n            currentUser: data.user\n          }\n        });\n        history.push('/');\n        dispatch(retrieve(data.user));\n      }\n    });\n  };\n};\nexport const checkLoggedIn = () => {\n  return dispatch => {\n    fetch(`http://localhost:3000/api/v1/logged_in`, {\n      credentials: 'include'\n    }).then(res => res.json()).then(data => dispatch({\n      type: \"AUTH_SUCCESS\",\n      payload: {\n        loggedIn: data.logged_in,\n        currentUser: data.user\n      }\n    }));\n  };\n};\nexport const logout = () => {\n  return dispatch => {\n    fetch(`http://localhost:3000/api/v1/logout`, {\n      method: \"DELETE\",\n      credentials: \"include\"\n    }).then(res => res.json()).then(data => dispatch({\n      type: \"LOGOUT_SUCCESS\"\n    }));\n  };\n};\nexport const save = (user, hist = [], inventory = [], knownObjects = ['crowbar', 'door', 'desk', 'drawer', 'paper', 'candle', 'chest'], brokenObjects = [], uniqueEvents = {\n  openedChest: false,\n  meltedIce: false,\n  completedGame: false\n}) => {\n  console.log('Save action initiated.');\n  if (user.auth.currentUser) user = user.auth.currentUser;\n  return dispatch => {\n    fetch(`http://localhost:3000/api/v1/users/${user.id}`, {\n      method: 'POST',\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      credentials: 'include',\n      body: JSON.stringify({\n        history: hist,\n        inventory: inventory,\n        known_objects: knownObjects,\n        broken_objects: brokenObjects,\n        unique_events: uniqueEvents\n      })\n    }).then(res => res.json()).then(data => {\n      dispatch({\n        type: \"USER_HISTORY_FETCH_SUCCESS\",\n        payload: {\n          currentUser: user,\n          userHistory: hist,\n          userObjects: inventory,\n          knownObjects,\n          brokenObjects,\n          uniqueEvents\n        }\n      });\n    });\n  };\n};\nexport const retrieve = user => {\n  console.log('Retrieve initiated.');\n  console.log(user);\n  return dispatch => {\n    fetch(`http://localhost:3000/api/v1/users/${user.id}`, {\n      credentials: \"include\",\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      }\n    }).then(r => r.json()).then(data => dispatch({\n      type: \"USER_HISTORY_FETCH_SUCCESS\",\n      payload: {\n        currentUser: user,\n        userHistory: data.history,\n        userObjects: data.inventory,\n        knownObjects: data.known_objects,\n        brokenObjects: data.broken_objects,\n        unique_events: data.uniqueEvents\n      }\n    })).catch(error => {\n      console.log(\"Error: \", error);\n    });\n  };\n};","map":{"version":3,"sources":["/home/loots/code/5-phase/reactventure/frontend/src/actions/auth.js"],"names":["signup","userData","dispatch","fetch","method","headers","credentials","body","JSON","stringify","user","then","res","json","data","type","payload","loggedIn","currentUser","save","openedChest","meltedIce","completedGame","login","history","resp","error","alert","push","retrieve","checkLoggedIn","logged_in","logout","hist","inventory","knownObjects","brokenObjects","uniqueEvents","console","log","auth","id","known_objects","broken_objects","unique_events","userHistory","userObjects","Accept","r","catch"],"mappings":"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","sourcesContent":["export const signup = (userData) => {\n   return dispatch => {\n      fetch(`http://localhost:3000/api/v1/users`, {\n         method: 'POST',\n         headers: {\n            'Content-Type': 'application/json'\n         },\n         credentials: \"include\",\n         body: JSON.stringify({user: userData})\n      })\n      .then(res => res.json())\n      .then(data => {\n         dispatch({\n         type: \"AUTH_SUCCESS\",\n         payload: {\n            loggedIn: true,\n            currentUser: data.user\n            }\n         })\n         dispatch(save(\n            data.user,\n            [],                                                          // History\n            [],                                                          // Inventory\n            ['crowbar','door','desk','drawer','paper','candle','chest'], // knownObjects\n            [],                                                          // brokenObjects\n            {openedChest: false, meltedIce: false, completedGame: false} // uniqueEvents\n         )) // Default values at beginning of game\n      })\n   }\n}\n\nexport const login = (userData, history) => {\n   return dispatch => {\n      fetch(\"http://localhost:3000/api/v1/sessions\", {\n         method: \"POST\",\n         headers: {\n            \"Content-Type\": \"application/json\",\n         },\n         credentials: 'include',\n         body: JSON.stringify(userData)\n      })\n      .then(resp => resp.json())\n      .then(data => {\n         if (data.error) {\n            alert(data.error);\n         } else {\n            dispatch({\n               type: \"AUTH_SUCCESS\",\n               payload: {\n                  loggedIn: true,\n                  currentUser: data.user\n               }\n            })\n            history.push('/')\n            dispatch(retrieve(data.user))\n         }\n      })\n   }\n}\n\nexport const checkLoggedIn = () => {\n   return dispatch => {\n      fetch(`http://localhost:3000/api/v1/logged_in`, {\n         credentials: 'include'\n      })\n      .then(res => res.json())\n      .then(data => dispatch({\n         type: \"AUTH_SUCCESS\",\n         payload: {\n            loggedIn: data.logged_in,\n            currentUser: data.user\n         }\n      }))\n   }\n}\n\nexport const logout = () => {\n   return dispatch => {\n      fetch(`http://localhost:3000/api/v1/logout`, {\n         method: \"DELETE\",\n         credentials: \"include\"\n      })\n      .then(res => res.json())\n      .then(data => dispatch({type: \"LOGOUT_SUCCESS\"}))\n   }\n}\n\nexport const save = (user, hist=[], inventory=[], knownObjects=['crowbar','door','desk','drawer','paper','candle','chest'], brokenObjects=[], uniqueEvents={openedChest: false, meltedIce: false, completedGame: false}) => {\n   console.log('Save action initiated.')\n   if (user.auth.currentUser) user = user.auth.currentUser\n   return dispatch => {\n      fetch(`http://localhost:3000/api/v1/users/${user.id}`, {\n         method: 'POST',\n         headers: {\n            \"Content-Type\": \"application/json\",\n         },\n         credentials: 'include',\n         body: JSON.stringify({\n            history: hist,\n            inventory: inventory,\n            known_objects: knownObjects,\n            broken_objects: brokenObjects,\n            unique_events: uniqueEvents\n         })\n      })\n      .then(res => res.json())\n      .then(data => {\n         dispatch({\n            type: \"USER_HISTORY_FETCH_SUCCESS\",\n            payload: {\n               currentUser: user,\n               userHistory: hist,\n               userObjects: inventory,\n               knownObjects,\n               brokenObjects,\n               uniqueEvents\n            }\n         })\n      })\n   }\n}\n\nexport const retrieve = (user) => {\n   console.log('Retrieve initiated.')\n   console.log(user)\n   return dispatch => {\n      fetch(`http://localhost:3000/api/v1/users/${user.id}`, {\n         credentials: \"include\",\n         method: \"GET\",\n         headers: {\n            \"Content-Type\": \"application/json\",\n            Accept: \"application/json\"\n         }\n      })\n      .then(r => r.json())\n      .then(data => dispatch({\n            type: \"USER_HISTORY_FETCH_SUCCESS\",\n            payload: {\n               currentUser: user,\n               userHistory: data.history,\n               userObjects: data.inventory,\n               knownObjects: data.known_objects,\n               brokenObjects: data.broken_objects,\n               unique_events: data.uniqueEvents\n               }\n            })\n      )\n      .catch(error => {\n         console.log(\"Error: \", error);\n      })\n   }\n}\n"]},"metadata":{},"sourceType":"module"}